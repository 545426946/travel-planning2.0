<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <view class="header-content">
      <text class="page-title">è¡Œç¨‹è§„åˆ’</text>
      <text class="page-subtitle">åˆ›å»ºå±äºä½ çš„å®Œç¾æ—…è¡Œè®¡åˆ’</text>
    </view>
  </view>

  <!-- åˆ›å»ºè¡Œç¨‹æŒ‰é’®ç»„ -->
  <view class="create-section">
    <button class="create-btn manual" bindtap="createNewPlan">
      <view class="btn-icon"></view>
      <text>æ‰‹åŠ¨åˆ›å»º</text>
    </button>
    <button class="create-btn ai" bindtap="createNewPlan">
      <view class="btn-icon"></view>
      <text>AIæ™ºèƒ½è§„åˆ’</text>
    </button>
  </view>

  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <view class="filter-item {{filterStatus === 'all' ? 'active' : ''}}" 
          bindtap="changeFilter" 
          data-status="all">
      <text>å…¨éƒ¨</text>
    </view>
    <view class="filter-item {{filterStatus === 'planned' ? 'active' : ''}}" 
          bindtap="changeFilter" 
          data-status="planned">
      <text>è®¡åˆ’ä¸­</text>
    </view>
    <view class="filter-item {{filterStatus === 'ongoing' ? 'active' : ''}}" 
          bindtap="changeFilter" 
          data-status="ongoing">
      <text>è¿›è¡Œä¸­</text>
    </view>
    <view class="filter-item {{filterStatus === 'completed' ? 'active' : ''}}" 
          bindtap="changeFilter" 
          data-status="completed">
      <text>å·²å®Œæˆ</text>
    </view>
  </view>

  <!-- æˆ‘çš„è¡Œç¨‹åˆ—è¡¨ -->
  <view class="plans-section">
    <view class="section-title">æˆ‘çš„è¡Œç¨‹</view>
    
    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-container">
      <text>åŠ è½½ä¸­...</text>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:elif="{{travelPlans.length === 0}}" class="empty-state">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">è¿˜æ²¡æœ‰è¡Œç¨‹è®¡åˆ’</text>
      <text class="empty-hint">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªè¡Œç¨‹å§</text>
    </view>

    <!-- è¡Œç¨‹åˆ—è¡¨ -->
    <view wx:else class="plan-list">
      <view wx:for="{{travelPlans}}" 
            wx:key="id" 
            class="plan-card"
            bindtap="viewPlanDetail"
            data-id="{{item.id}}">
        
        <!-- è¡Œç¨‹å›¾ç‰‡ -->
        <image class="plan-image" src="{{item.image}}" mode="aspectFill" />
        
        <!-- AIæ ‡è®° -->
        <view wx:if="{{item.isAIGenerated}}" class="ai-badge">
          <text>AIç”Ÿæˆ</text>
        </view>

        <!-- è¡Œç¨‹ä¿¡æ¯ -->
        <view class="plan-info">
          <view class="plan-header">
            <text class="plan-title" user-select="{{true}}">{{item.title}}</text>
            <view class="plan-status" style="background-color: {{getStatusColor(item.status)}}">
              <text user-select="{{true}}">{{getStatusText(item.status)}}</text>
            </view>
          </view>

          <text class="plan-description" user-select="{{true}}">{{item.description}}</text>

          <!-- è¡Œç¨‹å…ƒæ•°æ® -->
          <view class="plan-meta">
            <view class="meta-item">
              <text class="meta-icon">ğŸ“…</text>
              <text class="meta-text" user-select="{{true}}">{{item.totalDays}}å¤©</text>
            </view>
            <view class="meta-item">
              <text class="meta-icon">ğŸ‘¥</text>
              <text class="meta-text" user-select="{{true}}">{{item.travelers}}äºº</text>
            </view>
            <view class="meta-item">
              <text class="meta-icon">ğŸ’°</text>
              <text class="meta-text" user-select="{{true}}">Â¥{{item.budget}}</text>
            </view>
            <view class="meta-item">
              <text class="meta-icon">ğŸ“</text>
              <text class="meta-text" user-select="{{true}}">{{item.destination}}</text>
            </view>
          </view>

          <!-- æ ‡ç­¾ -->
          <view wx:if="{{item.tags && item.tags.length > 0}}" class="plan-tags">
            <view wx:for="{{item.tags}}" wx:key="index" wx:for-item="tag" class="tag">
              <text user-select="{{true}}">{{tag}}</text>
            </view>
          </view>

          <!-- æ“ä½œæŒ‰é’® -->
          <view class="plan-actions">
            <button class="action-btn view" 
                    catchtap="viewPlanDetail" 
                    data-id="{{item.id}}">
              <text>æŸ¥çœ‹</text>
            </button>
            <button class="action-btn edit" 
                    catchtap="editPlan" 
                    data-id="{{item.id}}">
              <text>ç¼–è¾‘</text>
            </button>
            <button class="action-btn more" 
                    catchtap="showMoreActions" 
                    data-id="{{item.id}}"
                    data-title="{{item.title}}">
              <text>æ›´å¤š</text>
            </button>
          </view>
        </view>
      </view>
    </view>
  </view>
</view>
